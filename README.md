# yelp_star_classification_NLP


æœ¬é¡¹ç›®åŸºäº **PyTorch** å®ç°äº† Yelp è¯„è®ºæ˜Ÿçº§åˆ†ç±»ä»»åŠ¡ï¼Œæ—¨åœ¨é€šè¿‡ç”¨æˆ·è¯„è®ºæ–‡æœ¬é¢„æµ‹å¯¹åº”çš„æ˜Ÿçº§è¯„åˆ†ã€‚  
é¡¹ç›®åŒ…å« **CNNã€TextCNN** ç­‰å¤šç§æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œå¹¶æ”¯æŒä½¿ç”¨ **Word2Vec é¢„è®­ç»ƒè¯å‘é‡ï¼ˆå¯å¾®è°ƒï¼‰** æå‡åˆ†ç±»æ•ˆæœã€‚

---

## âœ¨ ç‰¹æ€§
- **å¤šæ¨¡å‹å®ç°**ï¼šç®€å• CNNã€CNN+MLPã€TextCNNï¼Œä»¥åŠ Word2Vec + CNNã€‚
- **è¯å‘é‡æ”¯æŒ**ï¼šéšæœºåˆå§‹åŒ–æˆ–åŠ è½½é¢„è®­ç»ƒ Word2Vec embeddingï¼Œå¹¶å¯é€‰æ‹©å¾®è°ƒã€‚
- **æ¨¡å—åŒ–ä»£ç **ï¼šæ¸…æ™°çš„æ¨¡å‹ã€è®­ç»ƒã€æ•°æ®å¤„ç†ç»“æ„ï¼Œä¾¿äºæ‰©å±•ã€‚
- **å®Œæ•´è®­ç»ƒæµç¨‹**ï¼šæ¶µç›–æ•°æ®é¢„å¤„ç†ã€è®­ç»ƒã€éªŒè¯ä¸è¯„ä¼°ã€‚

---

# æ•°æ®é›†
Yelp Reviewsæ˜¯Yelpä¸ºäº†å­¦ä¹ ç›®çš„è€Œå‘å¸ƒçš„ä¸€ä¸ªå¼€æºæ•°æ®é›†ã€‚å®ƒåŒ…å«äº†ç”±æ•°ç™¾ä¸‡ç”¨æˆ·è¯„è®ºï¼Œå•†ä¸šå±æ€§å’Œæ¥è‡ªå¤šä¸ªå¤§éƒ½å¸‚åœ°åŒºçš„è¶…è¿‡20ä¸‡å¼ ç…§ç‰‡ã€‚è¿™æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„å…¨çƒNLPæŒ‘æˆ˜æ•°æ®é›†ï¼ŒåŒ…å«5,200,000æ¡è¯„è®ºï¼Œ174,000æ¡å•†ä¸šå±æ€§ã€‚ æ•°æ®é›†ä¸‹è½½åœ°å€ä¸ºï¼š

	https://www.yelp.com/dataset/download

Yelp Reviewsæ ¼å¼åˆ†ä¸ºJSONå’ŒSQLä¸¤ç§ï¼Œä»¥JSONæ ¼å¼ä¸ºä¾‹,å…¶ä¸­æœ€é‡è¦çš„review.json,åŒ…å«è¯„è®ºæ•°æ®ã€‚Yelp Reviewsæ•°æ®é‡å·¨å¤§ï¼Œéå¸¸é€‚åˆéªŒè¯CNNæ¨¡å‹ã€‚
# æ•°æ®æ¸…æ´—
Yelp Reviewsæ–‡ä»¶æ ¼å¼ä¸ºJSONå’ŒSQLï¼Œä½¿ç”¨èµ·æ¥å¹¶ä¸æ˜¯ååˆ†æ–¹ä¾¿ã€‚ä¸“é—¨æœ‰ä¸ªå¼€æºé¡¹ç›®ç”¨äºè§£æè¯¥JSONæ–‡ä»¶ï¼š

> https://github.com/Yelp/dataset-examples

è¯¥é¡¹ç›®å¯ä»¥å°†Yelp Reviewsçš„Yelp Reviewsè½¬æ¢æˆCSVæ ¼å¼ï¼Œä¾¿äºè¿›ä¸€æ­¥å¤„ç†ï¼Œè¯¥é¡¹ç›®çš„å®‰è£…éå¸¸ç®€ä¾¿ï¼ŒåŒæ­¥å®Œé¡¹ç›®åç›´æ¥å®‰è£…å³å¯ã€‚

	git clone https://github.com/Yelp/dataset-examples
	python setup.py install

å‡å¦‚éœ€è¦æŠŠreview.jsonè½¬æ¢æˆCSVæ ¼å¼ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š

	python json_to_csv_converter.py /dataset/yelp/dataset/review.json

å‘½ä»¤æ‰§è¡Œå®Œä»¥åï¼Œå°±ä¼šåœ¨review.jsonç›¸åŒç›®å½•ä¸‹ç”Ÿæˆå¯¹åº”çš„CSVæ–‡ä»¶review.csvã€‚æŸ¥çœ‹è¯¥CSVæ–‡ä»¶çš„è¡¨å¤´ï¼Œå†…å®¹å¦‚ä¸‹ï¼Œå…¶ä¸­æœ€é‡è¦çš„ä¸¤ä¸ªå­—æ®µå°±æ˜¯textå’Œstarsï¼Œåˆ†åˆ«ä»£è¡¨è¯„è¯­å’Œæ‰“åˆ†ã€‚

	#CSVæ ¼å¼è¡¨å¤´å†…å®¹ï¼š
	#funny,user_id,review_id,text,business_id,stars,date,useful,cool
		
ä½¿ç”¨pandasè¯»å–è¯¥CSVæ–‡ä»¶ï¼Œå¼€å‘é˜¶æ®µå¯ä»¥æŒ‡å®šä»…è¯»å–å‰10000è¡Œã€‚
	
	#å¼€å‘é˜¶æ®µè¯»å–å‰10000è¡Œ
	df = pd.read_csv(filename,sep=',',header=0,nrows=10000)
---
## ğŸ“¦ ç¯å¢ƒä¾èµ–
- Python >= 3.8  
- PyTorch >= 1.10  
- NumPy  
- Pandas  
- Scikit-learn  
- Gensim (ç”¨äºåŠ è½½ Word2Vec)  

å®‰è£…ä¾èµ–ï¼š
```bash
pip install -r requirements.txt
````

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### 1. æ•°æ®å‡†å¤‡

* æ•°æ®é›†ï¼šYelp è¯„è®ºæ•°æ®ï¼ˆæ–‡æœ¬ + æ˜Ÿçº§æ ‡ç­¾ï¼‰
* é¢„å¤„ç†ï¼šåˆ†è¯ã€å»åœç”¨è¯ã€æ„å»ºè¯å‘é‡å­—å…¸

å°†å¤„ç†åçš„æ•°æ®æ”¾å…¥ `data/` ç›®å½•ã€‚

### 2. è®­ç»ƒæ¨¡å‹

è¿è¡Œè®­ç»ƒè„šæœ¬ï¼š

```bash
# ä½¿ç”¨åŸºç¡€ TextCNN
python train_yelp_cnn.py --model textcnn

# ä½¿ç”¨ Word2Vec embedding (å¾®è°ƒ)
python train_yelp_cnn.py --model textcnn --embedding word2vec --fine_tune True
```

å¯é€‰å‚æ•°ï¼š

* `--model`ï¼šæ¨¡å‹ç±»å‹ (`cnn`, `textcnn`)
* `--embedding`ï¼šembedding åˆå§‹åŒ–æ–¹å¼ (`random`, `word2vec`)
* `--fine_tune`ï¼šæ˜¯å¦å¾®è°ƒé¢„è®­ç»ƒè¯å‘é‡ (`True`/`False`)

### 3. è¯„ä¼°æ¨¡å‹

è®­ç»ƒå®Œæˆåï¼Œè„šæœ¬ä¼šè‡ªåŠ¨åœ¨éªŒè¯é›†ä¸Šè¯„ä¼°å¹¶è¾“å‡ºå‡†ç¡®ç‡å’ŒF1åˆ†æ•°ã€‚

---

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
â”œâ”€â”€ data/                 # Yelp æ•°æ®é›† (æ–‡æœ¬ + æ ‡ç­¾)
â”œâ”€â”€ models/               # æ¨¡å‹å®ç° (CNN / TextCNN / Word2Vec+CNN)
â”‚   â”œâ”€â”€ cnn.py
â”‚   â”œâ”€â”€ textcnn.py
â”‚   â””â”€â”€ utils.py
â”œâ”€â”€ train_yelp_cnn.py     # è®­ç»ƒå…¥å£
â”œâ”€â”€ requirements.txt      # ä¾èµ–åŒ…
â””â”€â”€ README.md             # é¡¹ç›®è¯´æ˜
```

---

## ğŸ“Š å®éªŒç»“æœ (ç¤ºä¾‹)

| æ¨¡å‹            | Embedding  | Fine-tune | å‡†ç¡®ç‡(%) |
|---------------| ---------- | --------- |-------|
| CNN           | Random     | -         | 87.8  |
| CNN+MLP       | Random     | -         | 90.2  |
| TextCNN       | Pretrained | False     | 90.75 |
| TextCNN + W2V | Pretrained | True      | 91.5  |

---

## ğŸ“œ License

æœ¬é¡¹ç›®ä»…ç”¨äºå­¦ä¹ å’Œç ”ç©¶ï¼Œç¦æ­¢ç”¨äºå•†ä¸šç”¨é€”ã€‚

